<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Unity WebGL Player | %UNITY_PRODUCT_NAME%</title>
  <style>
    :root { --blue: #0066cc; }
    body {
      margin: 0; padding: 0;
      background: #f0f5f7;
      font-family: sans-serif;
      display: flex; justify-content: center; align-items: center;
      height: 100vh; width: 100vw;
      overflow: hidden;
    }
    #unity-wrapper {
      position: relative;
      width: 100%;
      max-width: 100vw;
      max-height: 100vh;
      aspect-ratio: 16 / 9;
    }
    #unity-container {
      width: 100%; height: 100%;
      background: #000; position: relative;
      box-shadow: 0 0 0 2px var(--blue);
    }
    #unity-canvas {
      width: 100%; height: 100%;
      display: block; background: #111;
    }
    #ascii-loader {
      position: absolute; inset: 0; display: grid; place-items: center;
      background: rgba(0,0,0,0.65);
      transition: opacity .25s ease;
    }
    .loader-panel {
      width: 80%; max-width: 720px; padding: 16px;
      background: #0b0b0b;
      border: 2px solid var(--blue); border-radius: 8px;
      font-family: ui-monospace, monospace;
      color: var(--blue);
    }
    .loader-title { margin: 0 0 8px 0; color: #cde6ff; font-size: 14px; }
    .loader-bar { white-space: pre; font-size: 14px; margin-top: 6px; }
    .loader-sub { margin-top: 10px; color: #8fbff0; font-size: 12px; }
    .hide { opacity: 0; pointer-events: none; }
    .corner { position: absolute; width: 12px; height: 12px; pointer-events: none; }
    .corner::before, .corner::after { content: ""; position: absolute; border-color: var(--blue); }
    .corner.tl { top: -8px; left: -8px; }
    .corner.tl::before { top:0; left:0; width:100%; border-top:2px solid var(--blue); }
    .corner.tl::after  { top:0; left:0; height:100%; border-left:2px solid var(--blue); }
    .corner.tr { top: -8px; right: -8px; }
    .corner.tr::before { top:0; right:0; width:100%; border-top:2px solid var(--blue); }
    .corner.tr::after  { top:0; right:0; height:100%; border-right:2px solid var(--blue); }
    .corner.bl { bottom: -8px; left: -8px; }
    .corner.bl::before { bottom:0; left:0; width:100%; border-bottom:2px solid var(--blue); }
    .corner.bl::after  { bottom:0; left:0; height:100%; border-left:2px solid var(--blue); }
    .corner.br { bottom: -8px; right: -8px; }
    .corner.br::before { bottom:0; right:0; width:100%; border-bottom:2px solid var(--blue); }
    .corner.br::after  { bottom:0; right:0; height:100%; border-right:2px solid var(--blue); }
  </style>
</head>
<body>
  <div id="unity-wrapper">
    <div id="unity-container" aria-live="polite" aria-busy="true">
      <canvas id="unity-canvas"></canvas>
      <div id="ascii-loader" role="status" aria-label="Loading">
        <div class="loader-panel">
          <p class="loader-title">loadingâ€¦</p>
          <div id="loader-bar" class="loader-bar">[................................] 0%</div>
          <div id="loader-sub" class="loader-sub">initializing</div>
        </div>
      </div>
    </div>
    <div class="corner tl"></div>
    <div class="corner tr"></div>
    <div class="corner bl"></div>
    <div class="corner br"></div>
  </div>

  <!-- Unity loader -->
  <script src="Build/Sorter.loader.js"></script>
  <script>
    const canvas = document.getElementById("unity-canvas");
    const overlay = document.getElementById("ascii-loader");
    const barEl  = document.getElementById("loader-bar");
    const subEl  = document.getElementById("loader-sub");

    function renderAscii(progress) {
      const cols = 32;
      const filled = Math.round(progress * cols);
      const empty  = cols - filled;
      barEl.textContent = `[${"#".repeat(filled)}${".".repeat(empty)}] ${Math.round(progress * 100)}%`;
    }

    renderAscii(0);

    createUnityInstance(canvas, {
      dataUrl: "Build/Sorter.data",
      frameworkUrl: "Build/Sorter.framework.js",
      codeUrl: "Build/Sorter.wasm",
      streamingAssetsUrl: "StreamingAssets",
      companyName: "%UNITY_COMPANY_NAME%",
      productName: "%UNITY_PRODUCT_NAME%",
      productVersion: "%UNITY_PRODUCT_VERSION%"
    }, (progress) => {
      renderAscii(progress);
      if (progress < 0.25) subEl.textContent = "loading assets";
      else if (progress < 0.5) subEl.textContent = "compiling wasm";
      else if (progress < 0.75) subEl.textContent = "linking";
      else if (progress < 1.0) subEl.textContent = "starting";
    }).then((unityInstance) => {
      overlay.classList.add("hide");
      document.getElementById("unity-container").setAttribute("aria-busy", "false");
      subEl.textContent = "ready";
      window.unityInstance = unityInstance;
    }).catch((message) => {
      subEl.textContent = "error";
      console.error(message);
      alert(message);
    });
  </script>
</body>
</html>
